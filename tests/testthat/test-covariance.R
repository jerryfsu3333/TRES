context("Covariance matrix")

test_that("Covariance matrix", {
  data("bat")
  x <- bat$x
  y <- bat$y
  fit_1d1 <- TRR.fit(bat$x, bat$y, u = c(14,14), method = "1D")
  # expect_equal(fit_1d1$Gamma[[1]][1:5], c(-0.00014302,0.00068032,0.00039628,0.00031333,0.00006079))
  expect_equal(fit_1d1$M_list[[1]][1:5], c(0.32888006,0.00685595,-0.09999852,-0.09008617,0.03594920))
  expect_equal(fit_1d1$U_list[[2]][1:5], c(0.00963257,0.00692476,-0.00068983,-0.00242814,0.00285420))
  expect_equal(fit_1d1$W0_list[[1]][[1]][1:5], c(-0.0019916035851673,0.0006808296771030,0.0009928202065522,0.0008029470156978,-0.0000252780783541), 1e-16)
  expect_equal(fit_1d1$Gamma[[1]][1:5,1], c(-0.0001430174884968,0.0006803169856420,0.0003962790662324,0.0003133330863327,0.0000607945005863), 1e-16)
})

